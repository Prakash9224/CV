["{\"nodes\":{\"Register_CustomDataset\":{\"action\":\"register\",\"parameters\":{\"label\":\"CustomDataset\",\"name\":\"custom_dataset\",\"rowLevelSecurityFilter\":\"\",\"runtime\":{\"SFDCtoken\":\"SFDCtoken\"}},\"sources\":[\"Join_Dataset_User\"]},\"Join_Dataset_User\":{\"action\":\"augment\",\"parameters\":{\"leftKey\":[\"OwnerId\"],\"relationship\":\"User\",\"rightKey\":[\"Id\"],\"rightSelect\":[\"Id\",\"Name\",\"Username\",\"FirstName\",\"LastName\",\"UserType\",\"IsActive\",\"FullPhotoUrl\",\"SmallPhotoUrl\"]},\"sources\":[\"Extract_InitialObject\",\"Extract_User\"]},\"Compute_Additional_Flags\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Snapshot Text Date\",\"name\":\"Snapshot_Text_Date\",\"saqlExpression\":\"toString(toDate('Snapshot_Date_sec_epoch'),\\\"yyyy-MM-dd\\\")\",\"type\":\"Text\"},{\"label\":\"CustomSnapshotFilter\",\"name\":\"CustomSnapshotFilter\",\"saqlExpression\":\"\\\"true\\\"\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Compute_Snapshot_Date\"]},\"Compute_Snapshot_Filter_Flag\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"Snapshot Filter Flag\",\"name\":\"SnapshotFilterFlag\",\"saqlExpression\":\"case when date_diff(\\\"day\\\", toDate(Snapshot_Date_sec_epoch), now()) > 30 then \\\"false\\\" else \\\"true\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Append_LatestSnapshot\"]},\"Remove_De_Dupe_Flag\":{\"action\":\"sliceDataset\",\"parameters\":{\"fields\":[{\"name\":\"RemoveDataFlag\"},{\"name\":\"SnapshotFilterFlag\"}],\"mode\":\"drop\"},\"sources\":[\"Filter_Snapshot_Data\"]},\"Extract_Existing_SnapshotDataset\":{\"action\":\"dataset\",\"parameters\":{\"name\":\"SnapshotDS\"}},\"Extract_User\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"Username\"},{\"name\":\"Name\"},{\"name\":\"FirstName\"},{\"name\":\"LastName\"},{\"name\":\"UserRoleId\"},{\"name\":\"UserType\"},{\"name\":\"IsActive\"},{\"name\":\"FullPhotoUrl\"},{\"name\":\"SmallPhotoUrl\"},{\"defaultValue\":\"N/A\",\"name\":\"ManagerId\"}],\"object\":\"User\",\"runtime\":{\"SFDCtoken\":\"SFDCtoken\"}}},\"Filter_Duplicate_Snapshot_Dates\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"RemoveDataFlag:EQ:false\"},\"sources\":[\"Compute_De_Dupe_Snapshot_Flag\"]},\"Register_SnapshotDataset\":{\"action\":\"register\",\"parameters\":{\"label\":\"SnapshotDS\",\"name\":\"SnapshotDS\"},\"sources\":[\"Remove_De_Dupe_Flag\"]},\"Filter_Source_Data\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"CustomSnapshotFilter:EQ:true\"},\"sources\":[\"Compute_Additional_Flags\"]},\"Filter_Snapshot_Data\":{\"action\":\"filter\",\"parameters\":{\"filter\":\"SnapshotFilterFlag:EQ:true\"},\"sources\":[\"Compute_Snapshot_Filter_Flag\"]},\"Extract_InitialObject\":{\"action\":\"sobjectDigest\",\"parameters\":{\"fields\":[{\"name\":\"Id\"},{\"name\":\"OwnerId\"},{\"name\":\"CreatedById\"},{\"name\":\"CreatedDate\"},{\"name\":\"Customer_Id__c\"},{\"name\":\"Name\"},{\"name\":\"IsDeleted\"},{\"name\":\"Demand__c\"},{\"name\":\"End_Date__c\"},{\"name\":\"Generation_Reading__c\"},{\"name\":\"LastModifiedById\"},{\"name\":\"LastModifiedDate\"},{\"name\":\"Reading_Type__c\"},{\"name\":\"Start_Date__c\"},{\"name\":\"Supply_Reading__c\"},{\"name\":\"SystemModstamp\"},{\"name\":\"Total_Comsumption__c\"},{\"name\":\"Total_Generation__c\"}],\"object\":\"Customer_Reading__c\"}},\"Compute_De_Dupe_Snapshot_Flag\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"label\":\"RemoveDataFlag\",\"name\":\"RemoveDataFlag\",\"saqlExpression\":\"case when 'Snapshot_Text_Date' == date_to_string(now(),\\\"yyyy-MM-dd\\\") || 'Snapshot_Text_Date' == \\\"1900-01-01\\\" then \\\"true\\\" else \\\"false\\\" end\",\"type\":\"Text\"}],\"mergeWithSource\":true},\"sources\":[\"Extract_Existing_SnapshotDataset\"]},\"Append_LatestSnapshot\":{\"action\":\"append\",\"parameters\":{\"enableDisjointedSchemaMerge\":true},\"sources\":[\"Filter_Source_Data\",\"Filter_Duplicate_Snapshot_Dates\"]},\"Compute_Snapshot_Date\":{\"action\":\"computeExpression\",\"parameters\":{\"computedFields\":[{\"firstDayOfWeek\":0,\"fiscalMonthOffset\":0,\"format\":\"yyyy-MM-dd\",\"label\":\"SnapshotDate\",\"name\":\"Snapshot_Date\",\"saqlExpression\":\"toDate(date_to_string(now(),\\\"yyyy-MM-dd\\\"),\\\"yyyy-MM-dd\\\")\",\"type\":\"Date\"}],\"mergeWithSource\":true},\"sources\":[\"Join_Dataset_User\"]}}}",null]